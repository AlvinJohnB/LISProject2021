"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=require("@babel/runtime/helpers/extends"),primitives=require("@react-pdf/primitives"),queue=require("queue"),React=require("react"),_asyncToGenerator=require("@babel/runtime/helpers/asyncToGenerator"),_regeneratorRuntime=require("@babel/runtime/regenerator"),BlobStream=require("blob-stream"),FontStore=require("@react-pdf/font"),renderPDF=require("@react-pdf/render"),PDFDocument=require("@react-pdf/pdfkit"),layoutDocument=require("@react-pdf/layout"),_objectWithoutPropertiesLoose=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),ReactFiberReconciler=require("react-reconciler"),scheduler=require("scheduler");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var renderer,_extends__default=_interopDefaultLegacy(_extends),primitives__namespace=_interopNamespace(primitives),queue__default=_interopDefaultLegacy(queue),React__default=_interopDefaultLegacy(React),_asyncToGenerator__default=_interopDefaultLegacy(_asyncToGenerator),_regeneratorRuntime__default=_interopDefaultLegacy(_regeneratorRuntime),BlobStream__default=_interopDefaultLegacy(BlobStream),FontStore__default=_interopDefaultLegacy(FontStore),renderPDF__default=_interopDefaultLegacy(renderPDF),PDFDocument__default=_interopDefaultLegacy(PDFDocument),layoutDocument__default=_interopDefaultLegacy(layoutDocument),_objectWithoutPropertiesLoose__default=_interopDefaultLegacy(_objectWithoutPropertiesLoose),ReactFiberReconciler__default=_interopDefaultLegacy(ReactFiberReconciler),propsEqual=function e(t,r){var n=Object.keys(t),o=Object.keys(r);if(n.length!==o.length)return!1;for(var u=0;u<n.length;u+=1){var a=n[u];if("render"===a&&!t[a]!=!r[a])return!1;if("children"!==a&&t[a]!==r[a]){if("object"==typeof t[a]&&"object"==typeof r[a]&&e(t[a],r[a]))continue;return!1}if("children"===a&&("string"==typeof t[a]||"string"==typeof r[a]))return t[a]===r[a]}return!0},emptyObject={},createRenderer=function(e){var t=e.onChange,r=void 0===t?function(){}:t;return ReactFiberReconciler__default.default({schedulePassiveEffects:scheduler.unstable_scheduleCallback,cancelPassiveEffects:scheduler.unstable_cancelCallback,supportsMutation:!0,isPrimaryRenderer:!1,warnsIfNotActing:!1,appendInitialChild:function(e,t){e.children.push(t)},createInstance:function(e,t){var r=t.style;return t.children,{type:e,box:{},style:r||{},props:_objectWithoutPropertiesLoose__default.default(t,["style","children"])||{},children:[]}},createTextInstance:function(e,t){return{type:"TEXT_INSTANCE",value:e}},finalizeInitialChildren:function(e,t,r){return!1},getPublicInstance:function(e){return e},prepareForCommit:function(){},clearContainer:function(){},prepareUpdate:function(e,t,r,n){return!propsEqual(r,n)},resetAfterCommit:r,resetTextContent:function(e){},getRootHostContext:function(){return emptyObject},getChildHostContext:function(){return emptyObject},shouldSetTextContent:function(e,t){return!1},now:Date.now,useSyncScheduling:!0,appendChild:function(e,t){e.children.push(t)},appendChildToContainer:function(e,t){"ROOT"===e.type?e.document=t:e.children.push(t)},insertBefore:function(e,t,r){var n,o=null===(n=e.children)||void 0===n?void 0:n.indexOf(r);void 0!==o&&-1!==o&&t&&e.children.splice(o,0,t)},removeChild:function(e,t){var r,n=null===(r=e.children)||void 0===r?void 0:r.indexOf(t);void 0!==n&&-1!==n&&e.children.splice(n,1)},removeChildFromContainer:function(e,t){var r,n=null===(r=e.children)||void 0===r?void 0:r.indexOf(t);void 0!==n&&-1!==n&&e.children.splice(n,1)},commitTextUpdate:function(e,t,r){e.value=r},commitUpdate:function(e,t,r,n,o){var u=o.style,a=_objectWithoutPropertiesLoose__default.default(o,["style"]);e.props=a,e.style=u}})},version="2.0.20",fontStore=new FontStore__default.default,events={},pdf=function(e){var t={type:"ROOT",document:null},r=(renderer=renderer||createRenderer({onChange:function(){for(var e,t=(null===(e=events.change)||void 0===e?void 0:e.slice())||[],r=0;r<t.length;r+=1)t[r]()}})).createContainer(t),n=function(e){renderer.updateContainer(e,r,null)};e&&n(e);var o=function(){var e=_asyncToGenerator__default.default(_regeneratorRuntime__default.default.mark(function e(r){var n,o,u,a,i;return _regeneratorRuntime__default.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=!0),n=t.document.props||{},o=n.pdfVersion,u=n.language,a=new PDFDocument__default.default({compress:r,pdfVersion:o,lang:u,displayTitle:!0,autoFirstPage:!1}),e.next=6,layoutDocument__default.default(t.document,fontStore);case 6:return i=e.sent,e.abrupt("return",renderPDF__default.default(a,i));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u=function(e){void 0===e&&(e={}),t.document.props.onRender&&t.document.props.onRender(e)};return{on:function(e,t){events[e]||(events[e]=[]),events[e].push(t)},container:t,toBlob:function(){var e=_asyncToGenerator__default.default(_regeneratorRuntime__default.default.mark(function e(){var t,r;return _regeneratorRuntime__default.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:return t=e.sent,r=t.pipe(BlobStream__default.default()),e.abrupt("return",new Promise(function(e,t){r.on("finish",function(){try{var n=r.toBlob("application/pdf");u({blob:n}),e(n)}catch(e){t(e)}}),r.on("error",t)}));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),toBuffer:function(){var e=_asyncToGenerator__default.default(_regeneratorRuntime__default.default.mark(function e(){return _regeneratorRuntime__default.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u(),e.abrupt("return",o());case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),toString:function(){var e=_asyncToGenerator__default.default(_regeneratorRuntime__default.default.mark(function e(){var t,r;return _regeneratorRuntime__default.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.next=3,o(!1);case 3:return r=e.sent,e.abrupt("return",new Promise(function(e,n){try{r.on("data",function(e){t+=e}),r.on("end",function(){u(),e(t)})}catch(e){n(e)}}));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),removeListener:function(e,t){if(events[e]){var r=events[e].indexOf(t);r>-1&&events[e].splice(r,1)}},updateContainer:n}},Font=fontStore,StyleSheet={create:function(e){return e}},usePDF=function(e){var t=e.document,r=React.useRef(null),n=React.useState({url:null,blob:null,error:null,loading:!1}),o=n[0],u=n[1];React.useEffect(function(){var e=queue__default.default({autostart:!0,concurrency:1}),n=function(){u(function(e){return _extends__default.default({},e,{loading:!0})}),e.splice(0,e.length,function(){return o.error?Promise.resolve():r.current.toBlob()})};return r.current=pdf(),r.current.on("change",n),r.current.updateContainer(t),e.on("error",function(e){console.error(e),u(function(t){return _extends__default.default({},t,{error:e})})}),e.on("success",function(e){u({blob:e,error:null,loading:!1,url:URL.createObjectURL(e)})}),function(){e.end(),r.current.removeListener("change",n)}},[]),React.useEffect(function(){return function(){o.url&&URL.revokeObjectURL(o.url)}},[o.url]);return[o,function(){r.current.updateContainer(t)}]},PDFViewer=function(e){var t=e.title,r=e.style,n=e.className,o=e.children,u=e.innerRef,a=e.showToolbar,i=void 0===a||a,c=_objectWithoutPropertiesLoose__default.default(e,["title","style","className","children","innerRef","showToolbar"]),l=usePDF({document:o}),d=l[0],f=l[1];React.useEffect(f,[o]);var s=d.url?d.url+"#toolbar="+(i?1:0):null;return React__default.default.createElement("iframe",_extends__default.default({src:s,title:t,ref:u,style:r,className:n},c))},BlobProvider=function(e){var t=e.document,r=e.children,n=usePDF({document:t}),o=n[0],u=n[1];return React.useEffect(u,[t]),t?r(o):(console.warn("You should pass a valid document to BlobProvider"),null)},PDFDownloadLink=function(e){var t=e.style,r=e.children,n=e.className,o=e.document,u=e.fileName,a=void 0===u?"document.pdf":u,i=usePDF({document:o}),c=i[0],l=i[1];if(React.useEffect(l,[r]),!o)return console.warn("You should pass a valid document to PDFDownloadLink"),null;return React__default.default.createElement("a",{style:t,href:c.url,download:a,className:n,onClick:function(){window.navigator.msSaveBlob&&window.navigator.msSaveBlob(c.blob,a)}},"function"==typeof r?r(c):r)},throwEnvironmentError=function(e){throw new Error(e+" is a Node specific API. You're either using this method in a browser, or your bundler is not loading react-pdf from the appropriate web build.")},renderToStream=function(){throwEnvironmentError("renderToStream")},renderToString=function(){throwEnvironmentError("renderToString")},renderToFile=function(){throwEnvironmentError("renderToFile")},render=function(){throwEnvironmentError("render")},index=_extends__default.default({pdf:pdf,usePDF:usePDF,Font:Font,version:version,StyleSheet:StyleSheet,PDFViewer:PDFViewer,BlobProvider:BlobProvider,PDFDownloadLink:PDFDownloadLink,renderToStream:renderToStream,renderToString:renderToString,renderToFile:renderToFile,render:render},primitives__namespace);exports.BlobProvider=BlobProvider,exports.Font=Font,exports.PDFDownloadLink=PDFDownloadLink,exports.PDFViewer=PDFViewer,exports.StyleSheet=StyleSheet,exports.createRenderer=createRenderer,exports.default=index,exports.pdf=pdf,exports.render=render,exports.renderToFile=renderToFile,exports.renderToStream=renderToStream,exports.renderToString=renderToString,exports.usePDF=usePDF,exports.version=version,Object.keys(primitives).forEach(function(e){"default"===e||exports.hasOwnProperty(e)||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return primitives[e]}})});
//# sourceMappingURL=react-pdf.browser.cjs.min.js.map
