"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var primitives=require("@react-pdf/primitives"),fs=require("fs"),BlobStream=require("blob-stream"),FontStore=require("@react-pdf/font"),renderPDF=require("@react-pdf/render"),PDFDocument=require("@react-pdf/pdfkit"),layoutDocument=require("@react-pdf/layout"),ReactFiberReconciler=require("react-reconciler"),scheduler=require("scheduler");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}}),r.default=e,Object.freeze(r)}var primitives__namespace=_interopNamespace(primitives),fs__default=_interopDefaultLegacy(fs),BlobStream__default=_interopDefaultLegacy(BlobStream),FontStore__default=_interopDefaultLegacy(FontStore),renderPDF__default=_interopDefaultLegacy(renderPDF),PDFDocument__default=_interopDefaultLegacy(PDFDocument),layoutDocument__default=_interopDefaultLegacy(layoutDocument),ReactFiberReconciler__default=_interopDefaultLegacy(ReactFiberReconciler);const propsEqual=(e,r)=>{const t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(let n=0;n<t.length;n+=1){const o=t[n];if("render"===o&&!e[o]!=!r[o])return!1;if("children"!==o&&e[o]!==r[o]){if("object"==typeof e[o]&&"object"==typeof r[o]&&propsEqual(e[o],r[o]))continue;return!1}if("children"===o&&("string"==typeof e[o]||"string"==typeof r[o]))return e[o]===r[o]}return!0},emptyObject={},createRenderer=({onChange:e=(()=>{})})=>ReactFiberReconciler__default.default({schedulePassiveEffects:scheduler.unstable_scheduleCallback,cancelPassiveEffects:scheduler.unstable_cancelCallback,supportsMutation:!0,isPrimaryRenderer:!1,warnsIfNotActing:!1,appendInitialChild(e,r){e.children.push(r)},createInstance:(e,{style:r,children:t,...n})=>({type:e,box:{},style:r||{},props:n||{},children:[]}),createTextInstance:(e,r)=>({type:"TEXT_INSTANCE",value:e}),finalizeInitialChildren:(e,r,t)=>!1,getPublicInstance:e=>e,prepareForCommit(){},clearContainer(){},prepareUpdate:(e,r,t,n)=>!propsEqual(t,n),resetAfterCommit:e,resetTextContent(e){},getRootHostContext:()=>emptyObject,getChildHostContext:()=>emptyObject,shouldSetTextContent:(e,r)=>!1,now:Date.now,useSyncScheduling:!0,appendChild(e,r){e.children.push(r)},appendChildToContainer(e,r){"ROOT"===e.type?e.document=r:e.children.push(r)},insertBefore(e,r,t){var n;const o=null===(n=e.children)||void 0===n?void 0:n.indexOf(t);void 0!==o&&-1!==o&&r&&e.children.splice(o,0,r)},removeChild(e,r){var t;const n=null===(t=e.children)||void 0===t?void 0:t.indexOf(r);void 0!==n&&-1!==n&&e.children.splice(n,1)},removeChildFromContainer(e,r){var t;const n=null===(t=e.children)||void 0===t?void 0:t.indexOf(r);void 0!==n&&-1!==n&&e.children.splice(n,1)},commitTextUpdate(e,r,t){e.value=t},commitUpdate(e,r,t,n,o){const{style:i,...a}=o;e.props=a,e.style=i}});var version="2.0.20";const fontStore=new FontStore__default.default;let renderer;const events={},pdf=e=>{const r={type:"ROOT",document:null},t=(renderer=renderer||createRenderer({onChange:()=>{var e;const r=(null===(e=events.change)||void 0===e?void 0:e.slice())||[];for(let e=0;e<r.length;e+=1)r[e]()}})).createContainer(r),n=e=>{renderer.updateContainer(e,t,null)};e&&n(e);const o=async(e=!0)=>{const t=r.document.props||{},{pdfVersion:n,language:o}=t,i=new PDFDocument__default.default({compress:e,pdfVersion:n,lang:o,displayTitle:!0,autoFirstPage:!1}),a=await layoutDocument__default.default(r.document,fontStore);return renderPDF__default.default(i,a)},i=(e={})=>{r.document.props.onRender&&r.document.props.onRender(e)};return{on:(e,r)=>{events[e]||(events[e]=[]),events[e].push(r)},container:r,toBlob:async()=>{const e=(await o()).pipe(BlobStream__default.default());return new Promise((r,t)=>{e.on("finish",()=>{try{const n=e.toBlob("application/pdf");i({blob:n}),r(n)}catch(e){t(e)}}),e.on("error",t)})},toBuffer:async()=>(i(),o()),toString:async()=>{let e="";const r=await o(!1);return new Promise((t,n)=>{try{r.on("data",r=>{e+=r}),r.on("end",()=>{i(),t(e)})}catch(e){n(e)}})},removeListener:(e,r)=>{if(!events[e])return;const t=events[e].indexOf(r);t>-1&&events[e].splice(t,1)},updateContainer:n}},Font=fontStore,StyleSheet={create:e=>e},renderToFile=async(e,r,t)=>{const n=pdf(e),o=await n.toBuffer(),i=fs__default.default.createWriteStream(r);return o.pipe(i),new Promise((e,n)=>{i.on("finish",()=>{t&&t(o,r),e(o)}),i.on("error",n)})},renderToStream=async e=>{const r=pdf(e);return await r.toBuffer()},renderToString=e=>{return pdf(e).toString()},throwEnvironmentError=e=>{throw new Error(`${e} is a web specific API. You're either using this component on Node, or your bundler is not loading react-pdf from the appropriate web build.`)},usePDF=()=>{throwEnvironmentError("usePDF")},PDFViewer=()=>{throwEnvironmentError("PDFViewer")},PDFDownloadLink=()=>{throwEnvironmentError("PDFDownloadLink")},BlobProvider=()=>{throwEnvironmentError("BlobProvider")},render=renderToFile;var index={pdf:pdf,Font:Font,version:version,StyleSheet:StyleSheet,usePDF:usePDF,PDFViewer:PDFViewer,BlobProvider:BlobProvider,PDFDownloadLink:PDFDownloadLink,renderToStream:renderToStream,renderToString:renderToString,renderToFile:renderToFile,render:render,...primitives__namespace};exports.BlobProvider=BlobProvider,exports.Font=Font,exports.PDFDownloadLink=PDFDownloadLink,exports.PDFViewer=PDFViewer,exports.StyleSheet=StyleSheet,exports.createRenderer=createRenderer,exports.default=index,exports.pdf=pdf,exports.render=render,exports.renderToFile=renderToFile,exports.renderToStream=renderToStream,exports.renderToString=renderToString,exports.usePDF=usePDF,exports.version=version,Object.keys(primitives).forEach(function(e){"default"===e||exports.hasOwnProperty(e)||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return primitives[e]}})});
//# sourceMappingURL=react-pdf.cjs.min.js.map
